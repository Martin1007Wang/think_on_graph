2025-05-13 15:04:18,756 - __main__ - INFO - Loading path dataset from: /mnt/wangjingxiong/think_on_graph/data/processed/webqsp_train/path_data.json
2025-05-13 15:04:18,873 - __main__ - INFO - Loaded 6289 path items from input.
2025-05-13 15:04:18,873 - __main__ - INFO - Starting SFT example generation with config: ProcessingConfig(max_selection_count=3, enable_relation_sampling=False, relation_sampling_threshold=20, num_distractors_to_sample=7, candidate_strategy=<CandidateStrategy.KG_ALLHOP: 'kg_allhop'>, positive_source_field=<PositiveSource.SHORTEST_PATHS: 'shortest_paths'>)
2025-05-13 15:04:18,873 - src.knowledge_graph - INFO - KnowledgeGraph will use device: cuda for SentenceTransformer models when loaded.
2025-05-13 15:04:18,873 - src.knowledge_graph - INFO - FAISS library is available and will be used for efficient entity search.
2025-05-13 15:04:18,886 - src.knowledge_graph - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-05-13 15:04:18,889 - src.knowledge_graph - INFO - Database indexes ensured.
Processing path items to SFT examples:   0%|          | 0/6289 [00:00<?, ?it/s]Processing path items to SFT examples:   0%|          | 15/6289 [00:00<00:42, 148.17it/s]Processing path items to SFT examples:   2%|▏         | 98/6289 [00:00<00:11, 545.46it/s]Processing path items to SFT examples:   3%|▎         | 176/6289 [00:00<00:09, 643.72it/s]Processing path items to SFT examples:   4%|▍         | 247/6289 [00:00<00:09, 669.53it/s]Processing path items to SFT examples:   5%|▍         | 314/6289 [00:00<00:13, 431.97it/s]Processing path items to SFT examples:   6%|▌         | 367/6289 [00:00<00:15, 385.07it/s]Processing path items to SFT examples:   7%|▋         | 412/6289 [00:01<00:20, 291.97it/s]Processing path items to SFT examples:   8%|▊         | 481/6289 [00:01<00:15, 368.05it/s]Processing path items to SFT examples:   9%|▉         | 553/6289 [00:01<00:12, 442.74it/s]Processing path items to SFT examples:  10%|▉         | 610/6289 [00:01<00:12, 440.10it/s]Processing path items to SFT examples:  11%|█         | 661/6289 [00:02<00:26, 214.18it/s]Processing path items to SFT examples:  12%|█▏        | 725/6289 [00:02<00:20, 271.98it/s]Processing path items to SFT examples:  12%|█▏        | 774/6289 [00:02<00:17, 307.31it/s]Processing path items to SFT examples:  13%|█▎        | 821/6289 [00:02<00:23, 231.03it/s]Processing path items to SFT examples:  14%|█▎        | 861/6289 [00:02<00:21, 257.05it/s]Processing path items to SFT examples:  15%|█▍        | 938/6289 [00:02<00:15, 346.92it/s]Processing path items to SFT examples:  16%|█▌        | 1008/6289 [00:02<00:12, 418.93it/s]Processing path items to SFT examples:  17%|█▋        | 1081/6289 [00:02<00:10, 488.81it/s]Processing path items to SFT examples:  19%|█▊        | 1171/6289 [00:03<00:08, 572.60it/s]Processing path items to SFT examples:  20%|█▉        | 1238/6289 [00:03<00:19, 261.83it/s]Processing path items to SFT examples:  21%|██        | 1319/6289 [00:03<00:14, 335.96it/s]Processing path items to SFT examples:  22%|██▏       | 1378/6289 [00:03<00:15, 324.83it/s]Processing path items to SFT examples:  23%|██▎       | 1428/6289 [00:04<00:14, 345.62it/s]Processing path items to SFT examples:  24%|██▎       | 1488/6289 [00:04<00:12, 392.14it/s]Processing path items to SFT examples:  24%|██▍       | 1540/6289 [00:04<00:19, 242.58it/s]Processing path items to SFT examples:  26%|██▌       | 1605/6289 [00:04<00:15, 303.21it/s]Processing path items to SFT examples:  27%|██▋       | 1694/6289 [00:04<00:11, 405.17it/s]Processing path items to SFT examples:  28%|██▊       | 1769/6289 [00:04<00:09, 473.75it/s]Processing path items to SFT examples:  29%|██▉       | 1833/6289 [00:05<00:09, 446.44it/s]Processing path items to SFT examples:  30%|███       | 1890/6289 [00:05<00:09, 470.49it/s]Processing path items to SFT examples:  31%|███▏      | 1978/6289 [00:05<00:07, 563.62it/s]Processing path items to SFT examples:  33%|███▎      | 2047/6289 [00:05<00:07, 594.50it/s]Processing path items to SFT examples:  34%|███▍      | 2124/6289 [00:05<00:06, 633.89it/s]Processing path items to SFT examples:  35%|███▍      | 2193/6289 [00:05<00:06, 595.30it/s]Processing path items to SFT examples:  36%|███▌      | 2257/6289 [00:05<00:06, 595.32it/s]Processing path items to SFT examples:  37%|███▋      | 2320/6289 [00:05<00:07, 560.81it/s]Processing path items to SFT examples:  38%|███▊      | 2379/6289 [00:06<00:07, 498.47it/s]Processing path items to SFT examples:  39%|███▉      | 2442/6289 [00:06<00:07, 530.28it/s]Processing path items to SFT examples:  40%|████      | 2526/6289 [00:06<00:06, 607.86it/s]Processing path items to SFT examples:  41%|████▏     | 2607/6289 [00:06<00:05, 651.41it/s]Processing path items to SFT examples:  43%|████▎     | 2675/6289 [00:06<00:05, 646.16it/s]Processing path items to SFT examples:  44%|████▎     | 2742/6289 [00:07<00:18, 194.11it/s]Processing path items to SFT examples:  44%|████▍     | 2792/6289 [00:07<00:15, 226.40it/s]Processing path items to SFT examples:  45%|████▌     | 2841/6289 [00:07<00:15, 229.34it/s]Processing path items to SFT examples:  46%|████▋     | 2914/6289 [00:07<00:11, 299.17it/s]Processing path items to SFT examples:  47%|████▋     | 2966/6289 [00:07<00:09, 336.14it/s]Processing path items to SFT examples:  48%|████▊     | 3025/6289 [00:08<00:12, 264.58it/s]Processing path items to SFT examples:  49%|████▉     | 3100/6289 [00:08<00:09, 341.69it/s]Processing path items to SFT examples:  50%|█████     | 3152/6289 [00:08<00:08, 359.23it/s]Processing path items to SFT examples:  52%|█████▏    | 3244/6289 [00:08<00:06, 471.60it/s]Processing path items to SFT examples:  53%|█████▎    | 3332/6289 [00:08<00:05, 562.34it/s]Processing path items to SFT examples:  54%|█████▍    | 3419/6289 [00:08<00:04, 636.04it/s]Processing path items to SFT examples:  56%|█████▌    | 3494/6289 [00:08<00:04, 620.84it/s]Processing path items to SFT examples:  57%|█████▋    | 3599/6289 [00:09<00:03, 730.09it/s]Processing path items to SFT examples:  59%|█████▊    | 3680/6289 [00:09<00:04, 587.95it/s]Processing path items to SFT examples:  60%|█████▉    | 3749/6289 [00:09<00:04, 603.85it/s]Processing path items to SFT examples:  61%|██████    | 3852/6289 [00:09<00:03, 707.30it/s]Processing path items to SFT examples:  63%|██████▎   | 3938/6289 [00:09<00:03, 745.18it/s]Processing path items to SFT examples:  64%|██████▍   | 4024/6289 [00:09<00:02, 774.08it/s]Processing path items to SFT examples:  65%|██████▌   | 4106/6289 [00:09<00:02, 757.19it/s]Processing path items to SFT examples:  67%|██████▋   | 4185/6289 [00:09<00:03, 599.15it/s]Processing path items to SFT examples:  68%|██████▊   | 4252/6289 [00:10<00:03, 567.84it/s]Processing path items to SFT examples:  69%|██████▊   | 4317/6289 [00:10<00:03, 584.97it/s]Processing path items to SFT examples:  70%|██████▉   | 4380/6289 [00:10<00:03, 522.02it/s]Processing path items to SFT examples:  71%|███████   | 4436/6289 [00:10<00:05, 359.28it/s]Processing path items to SFT examples:  72%|███████▏  | 4511/6289 [00:10<00:04, 432.68it/s]Processing path items to SFT examples:  73%|███████▎  | 4565/6289 [00:10<00:03, 434.53it/s]Processing path items to SFT examples:  74%|███████▎  | 4625/6289 [00:10<00:03, 426.79it/s]Processing path items to SFT examples:  74%|███████▍  | 4673/6289 [00:11<00:05, 319.24it/s]Processing path items to SFT examples:  76%|███████▌  | 4751/6289 [00:11<00:03, 405.74it/s]Processing path items to SFT examples:  77%|███████▋  | 4825/6289 [00:11<00:03, 475.81it/s]Processing path items to SFT examples:  78%|███████▊  | 4884/6289 [00:11<00:02, 501.60it/s]Processing path items to SFT examples:  79%|███████▊  | 4942/6289 [00:11<00:03, 350.56it/s]Processing path items to SFT examples:  79%|███████▉  | 4989/6289 [00:12<00:05, 222.29it/s]Processing path items to SFT examples:  80%|████████  | 5034/6289 [00:12<00:05, 249.69it/s]Processing path items to SFT examples:  81%|████████  | 5105/6289 [00:12<00:03, 325.45it/s]Processing path items to SFT examples:  82%|████████▏ | 5175/6289 [00:12<00:02, 396.09it/s]Processing path items to SFT examples:  83%|████████▎ | 5229/6289 [00:12<00:02, 362.81it/s]Processing path items to SFT examples:  84%|████████▍ | 5282/6289 [00:12<00:03, 334.79it/s]Processing path items to SFT examples:  85%|████████▍ | 5323/6289 [00:13<00:05, 162.94it/s]Processing path items to SFT examples:  86%|████████▌ | 5378/6289 [00:13<00:04, 208.05it/s]Processing path items to SFT examples:  87%|████████▋ | 5454/6289 [00:13<00:02, 279.99it/s]Processing path items to SFT examples:  88%|████████▊ | 5508/6289 [00:13<00:02, 322.34it/s]Processing path items to SFT examples:  88%|████████▊ | 5557/6289 [00:14<00:02, 249.45it/s]Processing path items to SFT examples:  89%|████████▉ | 5619/6289 [00:14<00:02, 308.69it/s]Processing path items to SFT examples:  90%|█████████ | 5682/6289 [00:14<00:01, 368.11it/s]Processing path items to SFT examples:  91%|█████████ | 5733/6289 [00:14<00:01, 354.65it/s]Processing path items to SFT examples:  92%|█████████▏| 5810/6289 [00:14<00:01, 441.85it/s]Processing path items to SFT examples:  93%|█████████▎| 5870/6289 [00:14<00:00, 478.38it/s]Processing path items to SFT examples:  94%|█████████▍| 5927/6289 [00:15<00:00, 443.22it/s]Processing path items to SFT examples:  95%|█████████▌| 5990/6289 [00:15<00:00, 487.41it/s]Processing path items to SFT examples:  96%|█████████▌| 6045/6289 [00:15<00:00, 444.61it/s]Processing path items to SFT examples:  97%|█████████▋| 6094/6289 [00:15<00:00, 385.01it/s]Processing path items to SFT examples:  98%|█████████▊| 6137/6289 [00:15<00:00, 374.12it/s]Processing path items to SFT examples:  99%|█████████▉| 6220/6289 [00:15<00:00, 479.37it/s]Processing path items to SFT examples: 100%|█████████▉| 6273/6289 [00:15<00:00, 461.17it/s]Processing path items to SFT examples: 100%|██████████| 6289/6289 [00:15<00:00, 397.14it/s]
2025-05-13 15:04:34,726 - src.knowledge_graph - INFO - Closing Neo4j driver connection.
2025-05-13 15:04:34,726 - __main__ - INFO - SFT example generation complete. Total SFT examples: 16136
2025-05-13 15:04:34,988 - __main__ - INFO - SFT instruction dataset saved to JSON Lines: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_kg_allhop_pos_shortest_paths/sft_data.jsonl
Saving the dataset (0/1 shards):   0%|          | 0/16136 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 16136/16136 [00:00<00:00, 601470.72 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 16136/16136 [00:00<00:00, 598370.46 examples/s]
2025-05-13 15:04:35,314 - __main__ - INFO - SFT instruction dataset saved to Hugging Face disk format: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_kg_allhop_pos_shortest_paths
