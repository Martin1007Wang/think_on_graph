2025-05-13 15:03:57,981 - __main__ - INFO - Loading path dataset from: /mnt/wangjingxiong/think_on_graph/data/processed/webqsp_train/path_data.json
2025-05-13 15:03:58,098 - __main__ - INFO - Loaded 6289 path items from input.
2025-05-13 15:03:58,098 - __main__ - INFO - Starting SFT example generation with config: ProcessingConfig(max_selection_count=3, enable_relation_sampling=False, relation_sampling_threshold=20, num_distractors_to_sample=7, candidate_strategy=<CandidateStrategy.KG_ALLHOP: 'kg_allhop'>, positive_source_field=<PositiveSource.POSITIVE_PATHS: 'positive_paths'>)
2025-05-13 15:03:58,098 - src.knowledge_graph - INFO - KnowledgeGraph will use device: cuda for SentenceTransformer models when loaded.
2025-05-13 15:03:58,098 - src.knowledge_graph - INFO - FAISS library is available and will be used for efficient entity search.
2025-05-13 15:03:58,109 - src.knowledge_graph - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-05-13 15:03:58,112 - src.knowledge_graph - INFO - Database indexes ensured.
Processing path items to SFT examples:   0%|          | 0/6289 [00:00<?, ?it/s]Processing path items to SFT examples:   0%|          | 11/6289 [00:00<01:01, 102.28it/s]Processing path items to SFT examples:   1%|▏         | 87/6289 [00:00<00:13, 475.03it/s]Processing path items to SFT examples:   3%|▎         | 166/6289 [00:00<00:09, 615.38it/s]Processing path items to SFT examples:   4%|▎         | 235/6289 [00:00<00:09, 641.32it/s]Processing path items to SFT examples:   5%|▍         | 300/6289 [00:00<00:15, 391.40it/s]Processing path items to SFT examples:   6%|▌         | 350/6289 [00:00<00:16, 364.78it/s]Processing path items to SFT examples:   6%|▋         | 394/6289 [00:01<00:21, 275.08it/s]Processing path items to SFT examples:   7%|▋         | 438/6289 [00:01<00:19, 304.95it/s]Processing path items to SFT examples:   8%|▊         | 515/6289 [00:01<00:14, 403.31it/s]Processing path items to SFT examples:   9%|▉         | 566/6289 [00:01<00:13, 427.66it/s]Processing path items to SFT examples:  10%|▉         | 616/6289 [00:01<00:24, 234.30it/s]Processing path items to SFT examples:  10%|█         | 654/6289 [00:02<00:26, 212.40it/s]Processing path items to SFT examples:  11%|█▏        | 723/6289 [00:02<00:19, 287.30it/s]Processing path items to SFT examples:  12%|█▏        | 770/6289 [00:02<00:17, 309.88it/s]Processing path items to SFT examples:  13%|█▎        | 812/6289 [00:02<00:25, 217.03it/s]Processing path items to SFT examples:  14%|█▎        | 861/6289 [00:02<00:21, 257.08it/s]Processing path items to SFT examples:  15%|█▍        | 935/6289 [00:02<00:15, 343.37it/s]Processing path items to SFT examples:  16%|█▌        | 993/6289 [00:03<00:13, 391.21it/s]Processing path items to SFT examples:  17%|█▋        | 1066/6289 [00:03<00:11, 467.81it/s]Processing path items to SFT examples:  18%|█▊        | 1135/6289 [00:03<00:09, 521.78it/s]Processing path items to SFT examples:  19%|█▉        | 1196/6289 [00:03<00:22, 229.42it/s]Processing path items to SFT examples:  20%|██        | 1279/6289 [00:03<00:16, 310.25it/s]Processing path items to SFT examples:  21%|██▏       | 1350/6289 [00:04<00:13, 372.28it/s]Processing path items to SFT examples:  22%|██▏       | 1410/6289 [00:04<00:15, 325.26it/s]Processing path items to SFT examples:  23%|██▎       | 1460/6289 [00:04<00:13, 353.79it/s]Processing path items to SFT examples:  24%|██▍       | 1510/6289 [00:04<00:20, 228.94it/s]Processing path items to SFT examples:  25%|██▍       | 1568/6289 [00:04<00:16, 279.01it/s]Processing path items to SFT examples:  26%|██▌       | 1637/6289 [00:05<00:13, 348.97it/s]Processing path items to SFT examples:  27%|██▋       | 1716/6289 [00:05<00:10, 432.85it/s]Processing path items to SFT examples:  29%|██▊       | 1797/6289 [00:05<00:09, 486.35it/s]Processing path items to SFT examples:  30%|██▉       | 1858/6289 [00:05<00:10, 408.72it/s]Processing path items to SFT examples:  31%|███       | 1925/6289 [00:05<00:09, 460.53it/s]Processing path items to SFT examples:  32%|███▏      | 1995/6289 [00:05<00:08, 514.41it/s]Processing path items to SFT examples:  33%|███▎      | 2062/6289 [00:05<00:07, 551.78it/s]Processing path items to SFT examples:  34%|███▍      | 2143/6289 [00:05<00:06, 618.31it/s]Processing path items to SFT examples:  35%|███▌      | 2211/6289 [00:06<00:07, 569.03it/s]Processing path items to SFT examples:  36%|███▌      | 2273/6289 [00:06<00:06, 580.52it/s]Processing path items to SFT examples:  37%|███▋      | 2335/6289 [00:06<00:07, 531.36it/s]Processing path items to SFT examples:  38%|███▊      | 2392/6289 [00:06<00:08, 457.57it/s]Processing path items to SFT examples:  39%|███▉      | 2470/6289 [00:06<00:07, 532.68it/s]Processing path items to SFT examples:  40%|████      | 2546/6289 [00:06<00:06, 589.77it/s]Processing path items to SFT examples:  42%|████▏     | 2610/6289 [00:06<00:06, 596.84it/s]Processing path items to SFT examples:  43%|████▎     | 2674/6289 [00:06<00:05, 606.30it/s]Processing path items to SFT examples:  44%|████▎     | 2737/6289 [00:07<00:12, 292.86it/s]Processing path items to SFT examples:  44%|████▍     | 2785/6289 [00:08<00:20, 167.60it/s]Processing path items to SFT examples:  45%|████▌     | 2855/6289 [00:08<00:15, 223.58it/s]Processing path items to SFT examples:  46%|████▋     | 2915/6289 [00:08<00:12, 270.79it/s]Processing path items to SFT examples:  48%|████▊     | 2988/6289 [00:08<00:09, 342.76it/s]Processing path items to SFT examples:  48%|████▊     | 3044/6289 [00:08<00:12, 259.83it/s]Processing path items to SFT examples:  49%|████▉     | 3103/6289 [00:08<00:10, 305.13it/s]Processing path items to SFT examples:  50%|█████     | 3151/6289 [00:08<00:09, 334.92it/s]Processing path items to SFT examples:  51%|█████▏    | 3234/6289 [00:09<00:07, 433.68it/s]Processing path items to SFT examples:  53%|█████▎    | 3314/6289 [00:09<00:05, 514.92it/s]Processing path items to SFT examples:  54%|█████▍    | 3393/6289 [00:09<00:04, 579.39it/s]Processing path items to SFT examples:  55%|█████▌    | 3462/6289 [00:09<00:04, 581.18it/s]Processing path items to SFT examples:  56%|█████▌    | 3528/6289 [00:09<00:04, 590.73it/s]Processing path items to SFT examples:  58%|█████▊    | 3624/6289 [00:09<00:03, 688.84it/s]Processing path items to SFT examples:  59%|█████▉    | 3698/6289 [00:09<00:04, 572.88it/s]Processing path items to SFT examples:  60%|█████▉    | 3769/6289 [00:09<00:04, 604.57it/s]Processing path items to SFT examples:  61%|██████▏   | 3857/6289 [00:09<00:03, 672.45it/s]Processing path items to SFT examples:  63%|██████▎   | 3933/6289 [00:10<00:03, 695.06it/s]Processing path items to SFT examples:  64%|██████▎   | 4007/6289 [00:10<00:03, 698.39it/s]Processing path items to SFT examples:  65%|██████▍   | 4080/6289 [00:10<00:03, 668.27it/s]Processing path items to SFT examples:  66%|██████▌   | 4149/6289 [00:10<00:03, 645.17it/s]Processing path items to SFT examples:  67%|██████▋   | 4215/6289 [00:10<00:03, 526.00it/s]Processing path items to SFT examples:  68%|██████▊   | 4278/6289 [00:10<00:03, 539.54it/s]Processing path items to SFT examples:  69%|██████▉   | 4336/6289 [00:10<00:03, 547.61it/s]Processing path items to SFT examples:  70%|██████▉   | 4394/6289 [00:10<00:03, 498.01it/s]Processing path items to SFT examples:  71%|███████   | 4447/6289 [00:11<00:05, 345.60it/s]Processing path items to SFT examples:  72%|███████▏  | 4523/6289 [00:11<00:04, 427.39it/s]Processing path items to SFT examples:  73%|███████▎  | 4576/6289 [00:11<00:03, 435.35it/s]Processing path items to SFT examples:  74%|███████▎  | 4627/6289 [00:11<00:05, 290.26it/s]Processing path items to SFT examples:  75%|███████▍  | 4689/6289 [00:11<00:04, 347.31it/s]Processing path items to SFT examples:  76%|███████▌  | 4767/6289 [00:11<00:03, 433.82it/s]Processing path items to SFT examples:  77%|███████▋  | 4840/6289 [00:12<00:02, 499.66it/s]Processing path items to SFT examples:  78%|███████▊  | 4901/6289 [00:12<00:03, 381.15it/s]Processing path items to SFT examples:  79%|███████▊  | 4951/6289 [00:12<00:03, 383.22it/s]Processing path items to SFT examples:  79%|███████▉  | 4998/6289 [00:12<00:05, 231.12it/s]Processing path items to SFT examples:  80%|████████  | 5035/6289 [00:12<00:05, 250.08it/s]Processing path items to SFT examples:  81%|████████  | 5102/6289 [00:13<00:03, 321.09it/s]Processing path items to SFT examples:  82%|████████▏ | 5161/6289 [00:13<00:03, 373.09it/s]Processing path items to SFT examples:  83%|████████▎ | 5210/6289 [00:13<00:03, 334.81it/s]Processing path items to SFT examples:  84%|████████▍ | 5280/6289 [00:13<00:02, 410.76it/s]Processing path items to SFT examples:  85%|████████▍ | 5331/6289 [00:14<00:06, 159.38it/s]Processing path items to SFT examples:  86%|████████▌ | 5402/6289 [00:14<00:04, 218.54it/s]Processing path items to SFT examples:  87%|████████▋ | 5455/6289 [00:14<00:03, 253.22it/s]Processing path items to SFT examples:  88%|████████▊ | 5525/6289 [00:14<00:02, 280.26it/s]Processing path items to SFT examples:  89%|████████▊ | 5568/6289 [00:14<00:02, 253.00it/s]Processing path items to SFT examples:  90%|████████▉ | 5629/6289 [00:15<00:02, 309.40it/s]Processing path items to SFT examples:  91%|█████████ | 5695/6289 [00:15<00:01, 374.74it/s]Processing path items to SFT examples:  91%|█████████▏| 5745/6289 [00:15<00:01, 342.44it/s]Processing path items to SFT examples:  92%|█████████▏| 5817/6289 [00:15<00:01, 417.33it/s]Processing path items to SFT examples:  94%|█████████▎| 5881/6289 [00:15<00:00, 464.77it/s]Processing path items to SFT examples:  94%|█████████▍| 5936/6289 [00:15<00:00, 449.43it/s]Processing path items to SFT examples:  95%|█████████▌| 6001/6289 [00:15<00:00, 497.55it/s]Processing path items to SFT examples:  96%|█████████▋| 6056/6289 [00:15<00:00, 448.24it/s]Processing path items to SFT examples:  97%|█████████▋| 6106/6289 [00:16<00:00, 366.86it/s]Processing path items to SFT examples:  98%|█████████▊| 6148/6289 [00:16<00:00, 354.39it/s]Processing path items to SFT examples:  99%|█████████▉| 6237/6289 [00:16<00:00, 474.31it/s]Processing path items to SFT examples: 100%|██████████| 6289/6289 [00:16<00:00, 380.47it/s]
2025-05-13 15:04:14,642 - src.knowledge_graph - INFO - Closing Neo4j driver connection.
2025-05-13 15:04:14,642 - __main__ - INFO - SFT example generation complete. Total SFT examples: 16806
2025-05-13 15:04:14,917 - __main__ - INFO - SFT instruction dataset saved to JSON Lines: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_kg_allhop_pos_positive_paths/sft_data.jsonl
Saving the dataset (0/1 shards):   0%|          | 0/16806 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 16806/16806 [00:00<00:00, 607568.36 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 16806/16806 [00:00<00:00, 604566.86 examples/s]
2025-05-13 15:04:15,257 - __main__ - INFO - SFT instruction dataset saved to Hugging Face disk format: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_kg_allhop_pos_positive_paths
