2025-05-13 15:04:38,827 - __main__ - INFO - Loading path dataset from: /mnt/wangjingxiong/think_on_graph/data/processed/webqsp_train/path_data.json
2025-05-13 15:04:38,947 - __main__ - INFO - Loaded 6289 path items from input.
2025-05-13 15:04:38,947 - __main__ - INFO - Starting SFT example generation with config: ProcessingConfig(max_selection_count=3, enable_relation_sampling=False, relation_sampling_threshold=20, num_distractors_to_sample=7, candidate_strategy=<CandidateStrategy.PN_KG_SUPPLEMENT: 'pn_kg_supplement'>, positive_source_field=<PositiveSource.POSITIVE_PATHS: 'positive_paths'>)
2025-05-13 15:04:38,947 - src.knowledge_graph - INFO - KnowledgeGraph will use device: cuda for SentenceTransformer models when loaded.
2025-05-13 15:04:38,947 - src.knowledge_graph - INFO - FAISS library is available and will be used for efficient entity search.
2025-05-13 15:04:38,953 - src.knowledge_graph - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-05-13 15:04:38,957 - src.knowledge_graph - INFO - Database indexes ensured.
Processing path items to SFT examples:   0%|          | 0/6289 [00:00<?, ?it/s]Processing path items to SFT examples:   0%|          | 13/6289 [00:00<00:48, 129.53it/s]Processing path items to SFT examples:   1%|▏         | 92/6289 [00:00<00:12, 513.05it/s]Processing path items to SFT examples:   3%|▎         | 168/6289 [00:00<00:09, 624.68it/s]Processing path items to SFT examples:   4%|▎         | 235/6289 [00:00<00:09, 641.05it/s]Processing path items to SFT examples:   5%|▍         | 300/6289 [00:00<00:15, 396.00it/s]Processing path items to SFT examples:   6%|▌         | 350/6289 [00:00<00:15, 376.24it/s]Processing path items to SFT examples:   6%|▋         | 395/6289 [00:01<00:20, 284.13it/s]Processing path items to SFT examples:   7%|▋         | 438/6289 [00:01<00:19, 306.95it/s]Processing path items to SFT examples:   8%|▊         | 504/6289 [00:01<00:15, 381.40it/s]Processing path items to SFT examples:   9%|▉         | 569/6289 [00:01<00:12, 443.20it/s]Processing path items to SFT examples:  10%|▉         | 621/6289 [00:02<00:27, 204.98it/s]Processing path items to SFT examples:  10%|█         | 660/6289 [00:02<00:24, 230.15it/s]Processing path items to SFT examples:  11%|█▏        | 720/6289 [00:02<00:19, 290.27it/s]Processing path items to SFT examples:  12%|█▏        | 770/6289 [00:02<00:17, 317.01it/s]Processing path items to SFT examples:  13%|█▎        | 814/6289 [00:02<00:23, 231.40it/s]Processing path items to SFT examples:  14%|█▎        | 861/6289 [00:02<00:20, 268.27it/s]Processing path items to SFT examples:  15%|█▍        | 933/6289 [00:02<00:15, 352.79it/s]Processing path items to SFT examples:  16%|█▌        | 994/6289 [00:02<00:13, 391.95it/s]Processing path items to SFT examples:  17%|█▋        | 1074/6289 [00:03<00:10, 484.23it/s]Processing path items to SFT examples:  18%|█▊        | 1153/6289 [00:03<00:09, 558.21it/s]Processing path items to SFT examples:  19%|█▉        | 1218/6289 [00:03<00:20, 249.90it/s]Processing path items to SFT examples:  21%|██        | 1300/6289 [00:03<00:15, 327.91it/s]Processing path items to SFT examples:  22%|██▏       | 1359/6289 [00:04<00:13, 357.96it/s]Processing path items to SFT examples:  22%|██▏       | 1415/6289 [00:04<00:14, 330.49it/s]Processing path items to SFT examples:  23%|██▎       | 1468/6289 [00:04<00:13, 365.13it/s]Processing path items to SFT examples:  24%|██▍       | 1517/6289 [00:04<00:20, 228.97it/s]Processing path items to SFT examples:  25%|██▌       | 1581/6289 [00:04<00:16, 287.24it/s]Processing path items to SFT examples:  26%|██▋       | 1658/6289 [00:04<00:12, 369.73it/s]Processing path items to SFT examples:  28%|██▊       | 1731/6289 [00:05<00:10, 435.18it/s]Processing path items to SFT examples:  29%|██▊       | 1797/6289 [00:05<00:09, 468.56it/s]Processing path items to SFT examples:  30%|██▉       | 1856/6289 [00:05<00:10, 427.35it/s]Processing path items to SFT examples:  31%|███       | 1920/6289 [00:05<00:09, 471.31it/s]Processing path items to SFT examples:  32%|███▏      | 1996/6289 [00:05<00:07, 539.77it/s]Processing path items to SFT examples:  33%|███▎      | 2065/6289 [00:05<00:07, 577.08it/s]Processing path items to SFT examples:  34%|███▍      | 2136/6289 [00:05<00:06, 611.87it/s]Processing path items to SFT examples:  35%|███▌      | 2202/6289 [00:05<00:06, 584.60it/s]Processing path items to SFT examples:  36%|███▌      | 2264/6289 [00:06<00:07, 566.30it/s]Processing path items to SFT examples:  37%|███▋      | 2323/6289 [00:06<00:07, 514.47it/s]Processing path items to SFT examples:  38%|███▊      | 2377/6289 [00:06<00:08, 455.84it/s]Processing path items to SFT examples:  39%|███▉      | 2449/6289 [00:06<00:07, 519.35it/s]Processing path items to SFT examples:  40%|████      | 2525/6289 [00:06<00:06, 578.38it/s]Processing path items to SFT examples:  41%|████▏     | 2598/6289 [00:06<00:05, 617.84it/s]Processing path items to SFT examples:  42%|████▏     | 2663/6289 [00:06<00:06, 566.64it/s]Processing path items to SFT examples:  43%|████▎     | 2723/6289 [00:07<00:11, 304.62it/s]Processing path items to SFT examples:  44%|████▍     | 2769/6289 [00:07<00:21, 167.07it/s]Processing path items to SFT examples:  45%|████▌     | 2847/6289 [00:07<00:14, 231.99it/s]Processing path items to SFT examples:  46%|████▋     | 2914/6289 [00:08<00:11, 288.99it/s]Processing path items to SFT examples:  48%|████▊     | 2988/6289 [00:08<00:09, 360.27it/s]Processing path items to SFT examples:  48%|████▊     | 3047/6289 [00:08<00:11, 275.54it/s]Processing path items to SFT examples:  49%|████▉     | 3103/6289 [00:08<00:10, 312.13it/s]Processing path items to SFT examples:  50%|█████     | 3150/6289 [00:08<00:09, 338.61it/s]Processing path items to SFT examples:  51%|█████▏    | 3225/6289 [00:08<00:07, 417.97it/s]Processing path items to SFT examples:  52%|█████▏    | 3300/6289 [00:08<00:06, 490.77it/s]Processing path items to SFT examples:  54%|█████▍    | 3387/6289 [00:09<00:05, 577.57it/s]Processing path items to SFT examples:  55%|█████▍    | 3455/6289 [00:09<00:04, 600.69it/s]Processing path items to SFT examples:  56%|█████▌    | 3523/6289 [00:09<00:04, 599.90it/s]Processing path items to SFT examples:  58%|█████▊    | 3628/6289 [00:09<00:03, 718.99it/s]Processing path items to SFT examples:  59%|█████▉    | 3705/6289 [00:09<00:04, 569.98it/s]Processing path items to SFT examples:  60%|██████    | 3779/6289 [00:09<00:04, 607.99it/s]Processing path items to SFT examples:  61%|██████▏   | 3857/6289 [00:09<00:03, 650.68it/s]Processing path items to SFT examples:  63%|██████▎   | 3937/6289 [00:09<00:03, 686.24it/s]Processing path items to SFT examples:  64%|██████▍   | 4013/6289 [00:09<00:03, 704.45it/s]Processing path items to SFT examples:  65%|██████▍   | 4087/6289 [00:10<00:03, 701.54it/s]Processing path items to SFT examples:  66%|██████▌   | 4160/6289 [00:10<00:03, 651.93it/s]Processing path items to SFT examples:  67%|██████▋   | 4228/6289 [00:10<00:03, 525.77it/s]Processing path items to SFT examples:  68%|██████▊   | 4295/6289 [00:10<00:03, 559.28it/s]Processing path items to SFT examples:  69%|██████▉   | 4356/6289 [00:10<00:03, 568.55it/s]Processing path items to SFT examples:  70%|███████   | 4417/6289 [00:10<00:05, 358.55it/s]Processing path items to SFT examples:  71%|███████▏  | 4490/6289 [00:11<00:04, 428.51it/s]Processing path items to SFT examples:  72%|███████▏  | 4554/6289 [00:11<00:03, 437.28it/s]Processing path items to SFT examples:  74%|███████▎  | 4624/6289 [00:11<00:03, 492.21it/s]Processing path items to SFT examples:  74%|███████▍  | 4682/6289 [00:11<00:05, 318.78it/s]Processing path items to SFT examples:  76%|███████▌  | 4753/6289 [00:11<00:03, 386.66it/s]Processing path items to SFT examples:  77%|███████▋  | 4813/6289 [00:11<00:03, 429.03it/s]Processing path items to SFT examples:  78%|███████▊  | 4884/6289 [00:11<00:03, 464.43it/s]Processing path items to SFT examples:  79%|███████▊  | 4940/6289 [00:12<00:03, 344.34it/s]Processing path items to SFT examples:  79%|███████▉  | 4985/6289 [00:12<00:05, 229.02it/s]Processing path items to SFT examples:  80%|████████  | 5034/6289 [00:12<00:04, 261.13it/s]Processing path items to SFT examples:  81%|████████  | 5090/6289 [00:12<00:03, 311.38it/s]Processing path items to SFT examples:  82%|████████▏ | 5155/6289 [00:12<00:03, 375.14it/s]Processing path items to SFT examples:  83%|████████▎ | 5204/6289 [00:13<00:03, 345.07it/s]Processing path items to SFT examples:  84%|████████▍ | 5280/6289 [00:13<00:02, 429.72it/s]Processing path items to SFT examples:  85%|████████▍ | 5333/6289 [00:14<00:05, 168.43it/s]Processing path items to SFT examples:  86%|████████▌ | 5415/6289 [00:14<00:03, 239.17it/s]Processing path items to SFT examples:  87%|████████▋ | 5467/6289 [00:14<00:03, 262.89it/s]Processing path items to SFT examples:  88%|████████▊ | 5525/6289 [00:14<00:02, 283.10it/s]Processing path items to SFT examples:  89%|████████▊ | 5569/6289 [00:14<00:02, 266.65it/s]Processing path items to SFT examples:  90%|████████▉ | 5629/6289 [00:14<00:02, 322.96it/s]Processing path items to SFT examples:  91%|█████████ | 5701/6289 [00:14<00:01, 399.78it/s]Processing path items to SFT examples:  91%|█████████▏| 5754/6289 [00:15<00:01, 368.28it/s]Processing path items to SFT examples:  93%|█████████▎| 5819/6289 [00:15<00:01, 427.44it/s]Processing path items to SFT examples:  94%|█████████▎| 5882/6289 [00:15<00:00, 461.21it/s]Processing path items to SFT examples:  94%|█████████▍| 5935/6289 [00:15<00:00, 465.12it/s]Processing path items to SFT examples:  96%|█████████▌| 6007/6289 [00:15<00:00, 518.45it/s]Processing path items to SFT examples:  96%|█████████▋| 6063/6289 [00:15<00:00, 426.59it/s]Processing path items to SFT examples:  97%|█████████▋| 6111/6289 [00:15<00:00, 400.91it/s]Processing path items to SFT examples:  98%|█████████▊| 6155/6289 [00:15<00:00, 392.44it/s]Processing path items to SFT examples:  99%|█████████▉| 6239/6289 [00:16<00:00, 498.67it/s]Processing path items to SFT examples: 100%|██████████| 6289/6289 [00:16<00:00, 387.78it/s]
2025-05-13 15:04:55,175 - src.knowledge_graph - INFO - Closing Neo4j driver connection.
2025-05-13 15:04:55,176 - __main__ - INFO - SFT example generation complete. Total SFT examples: 21538
2025-05-13 15:04:55,419 - __main__ - INFO - SFT instruction dataset saved to JSON Lines: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_pn_kg_supplement_pos_positive_paths/sft_data.jsonl
Saving the dataset (0/1 shards):   0%|          | 0/21538 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 21538/21538 [00:00<00:00, 869200.91 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 21538/21538 [00:00<00:00, 864509.49 examples/s]
2025-05-13 15:04:55,707 - __main__ - INFO - SFT instruction dataset saved to Hugging Face disk format: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_pn_kg_supplement_pos_positive_paths
