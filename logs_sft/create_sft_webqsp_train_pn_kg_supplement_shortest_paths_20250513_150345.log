2025-05-13 15:04:59,245 - __main__ - INFO - Loading path dataset from: /mnt/wangjingxiong/think_on_graph/data/processed/webqsp_train/path_data.json
2025-05-13 15:04:59,364 - __main__ - INFO - Loaded 6289 path items from input.
2025-05-13 15:04:59,364 - __main__ - INFO - Starting SFT example generation with config: ProcessingConfig(max_selection_count=3, enable_relation_sampling=False, relation_sampling_threshold=20, num_distractors_to_sample=7, candidate_strategy=<CandidateStrategy.PN_KG_SUPPLEMENT: 'pn_kg_supplement'>, positive_source_field=<PositiveSource.SHORTEST_PATHS: 'shortest_paths'>)
2025-05-13 15:04:59,364 - src.knowledge_graph - INFO - KnowledgeGraph will use device: cuda for SentenceTransformer models when loaded.
2025-05-13 15:04:59,364 - src.knowledge_graph - INFO - FAISS library is available and will be used for efficient entity search.
2025-05-13 15:04:59,370 - src.knowledge_graph - INFO - Successfully connected to Neo4j at bolt://localhost:7687
2025-05-13 15:04:59,372 - src.knowledge_graph - INFO - Database indexes ensured.
Processing path items to SFT examples:   0%|          | 0/6289 [00:00<?, ?it/s]Processing path items to SFT examples:   0%|          | 14/6289 [00:00<00:45, 139.36it/s]Processing path items to SFT examples:   1%|▏         | 93/6289 [00:00<00:11, 520.68it/s]Processing path items to SFT examples:   3%|▎         | 176/6289 [00:00<00:09, 652.75it/s]Processing path items to SFT examples:   4%|▍         | 244/6289 [00:00<00:09, 663.23it/s]Processing path items to SFT examples:   5%|▍         | 311/6289 [00:00<00:14, 425.71it/s]Processing path items to SFT examples:   6%|▌         | 363/6289 [00:00<00:15, 380.61it/s]Processing path items to SFT examples:   6%|▋         | 408/6289 [00:01<00:20, 292.92it/s]Processing path items to SFT examples:   8%|▊         | 479/6289 [00:01<00:15, 373.92it/s]Processing path items to SFT examples:   9%|▊         | 546/6289 [00:01<00:13, 437.58it/s]Processing path items to SFT examples:  10%|▉         | 610/6289 [00:01<00:13, 430.34it/s]Processing path items to SFT examples:  10%|█         | 660/6289 [00:02<00:26, 212.66it/s]Processing path items to SFT examples:  12%|█▏        | 726/6289 [00:02<00:20, 273.07it/s]Processing path items to SFT examples:  12%|█▏        | 772/6289 [00:02<00:18, 297.19it/s]Processing path items to SFT examples:  13%|█▎        | 817/6289 [00:02<00:24, 222.53it/s]Processing path items to SFT examples:  14%|█▎        | 861/6289 [00:02<00:21, 255.13it/s]Processing path items to SFT examples:  15%|█▍        | 939/6289 [00:02<00:15, 344.54it/s]Processing path items to SFT examples:  16%|█▌        | 1012/6289 [00:02<00:12, 421.81it/s]Processing path items to SFT examples:  17%|█▋        | 1097/6289 [00:02<00:10, 515.22it/s]Processing path items to SFT examples:  19%|█▊        | 1173/6289 [00:03<00:14, 351.30it/s]Processing path items to SFT examples:  19%|█▉        | 1224/6289 [00:03<00:18, 275.35it/s]Processing path items to SFT examples:  21%|██        | 1310/6289 [00:03<00:13, 363.66it/s]Processing path items to SFT examples:  22%|██▏       | 1364/6289 [00:03<00:12, 390.67it/s]Processing path items to SFT examples:  23%|██▎       | 1417/6289 [00:04<00:14, 345.52it/s]Processing path items to SFT examples:  23%|██▎       | 1475/6289 [00:04<00:12, 389.56it/s]Processing path items to SFT examples:  24%|██▍       | 1524/6289 [00:04<00:20, 235.88it/s]Processing path items to SFT examples:  25%|██▌       | 1597/6289 [00:04<00:15, 309.76it/s]Processing path items to SFT examples:  27%|██▋       | 1693/6289 [00:04<00:10, 423.58it/s]Processing path items to SFT examples:  28%|██▊       | 1759/6289 [00:04<00:09, 469.82it/s]Processing path items to SFT examples:  29%|██▉       | 1822/6289 [00:05<00:09, 455.19it/s]Processing path items to SFT examples:  30%|██▉       | 1879/6289 [00:05<00:09, 476.07it/s]Processing path items to SFT examples:  31%|███▏      | 1968/6289 [00:05<00:07, 574.20it/s]Processing path items to SFT examples:  32%|███▏      | 2043/6289 [00:05<00:06, 617.44it/s]Processing path items to SFT examples:  34%|███▍      | 2124/6289 [00:05<00:06, 667.38it/s]Processing path items to SFT examples:  35%|███▍      | 2196/6289 [00:05<00:06, 615.22it/s]Processing path items to SFT examples:  36%|███▌      | 2262/6289 [00:05<00:06, 599.11it/s]Processing path items to SFT examples:  37%|███▋      | 2325/6289 [00:05<00:07, 544.63it/s]Processing path items to SFT examples:  38%|███▊      | 2383/6289 [00:06<00:08, 460.92it/s]Processing path items to SFT examples:  39%|███▉      | 2456/6289 [00:06<00:07, 517.99it/s]Processing path items to SFT examples:  40%|████      | 2535/6289 [00:06<00:06, 583.95it/s]Processing path items to SFT examples:  41%|████▏     | 2607/6289 [00:06<00:06, 600.92it/s]Processing path items to SFT examples:  42%|████▏     | 2671/6289 [00:06<00:05, 608.87it/s]Processing path items to SFT examples:  43%|████▎     | 2735/6289 [00:06<00:11, 302.24it/s]Processing path items to SFT examples:  44%|████▍     | 2784/6289 [00:07<00:21, 161.64it/s]Processing path items to SFT examples:  45%|████▌     | 2859/6289 [00:07<00:15, 220.71it/s]Processing path items to SFT examples:  46%|████▋     | 2916/6289 [00:07<00:12, 263.60it/s]Processing path items to SFT examples:  48%|████▊     | 3000/6289 [00:08<00:09, 348.87it/s]Processing path items to SFT examples:  49%|████▊     | 3060/6289 [00:08<00:11, 270.43it/s]Processing path items to SFT examples:  49%|████▉     | 3107/6289 [00:08<00:11, 280.65it/s]Processing path items to SFT examples:  51%|█████     | 3189/6289 [00:08<00:08, 369.33it/s]Processing path items to SFT examples:  52%|█████▏    | 3281/6289 [00:08<00:06, 474.07it/s]Processing path items to SFT examples:  53%|█████▎    | 3360/6289 [00:08<00:05, 541.11it/s]Processing path items to SFT examples:  55%|█████▍    | 3450/6289 [00:08<00:04, 618.25it/s]Processing path items to SFT examples:  56%|█████▌    | 3525/6289 [00:09<00:04, 615.03it/s]Processing path items to SFT examples:  58%|█████▊    | 3629/6289 [00:09<00:03, 718.29it/s]Processing path items to SFT examples:  59%|█████▉    | 3709/6289 [00:09<00:04, 604.96it/s]Processing path items to SFT examples:  60%|██████    | 3780/6289 [00:09<00:03, 627.50it/s]Processing path items to SFT examples:  62%|██████▏   | 3879/6289 [00:09<00:03, 717.14it/s]Processing path items to SFT examples:  63%|██████▎   | 3958/6289 [00:09<00:03, 735.28it/s]Processing path items to SFT examples:  64%|██████▍   | 4043/6289 [00:09<00:02, 752.73it/s]Processing path items to SFT examples:  66%|██████▌   | 4122/6289 [00:09<00:03, 712.26it/s]Processing path items to SFT examples:  67%|██████▋   | 4196/6289 [00:10<00:03, 644.71it/s]Processing path items to SFT examples:  68%|██████▊   | 4264/6289 [00:10<00:03, 608.94it/s]Processing path items to SFT examples:  69%|██████▉   | 4333/6289 [00:10<00:03, 624.99it/s]Processing path items to SFT examples:  70%|██████▉   | 4398/6289 [00:10<00:03, 570.38it/s]Processing path items to SFT examples:  71%|███████   | 4457/6289 [00:10<00:04, 398.40it/s]Processing path items to SFT examples:  72%|███████▏  | 4538/6289 [00:10<00:03, 481.03it/s]Processing path items to SFT examples:  73%|███████▎  | 4596/6289 [00:10<00:03, 464.23it/s]Processing path items to SFT examples:  74%|███████▍  | 4649/6289 [00:11<00:05, 306.48it/s]Processing path items to SFT examples:  75%|███████▌  | 4730/6289 [00:11<00:03, 392.01it/s]Processing path items to SFT examples:  76%|███████▌  | 4793/6289 [00:11<00:03, 438.55it/s]Processing path items to SFT examples:  78%|███████▊  | 4880/6289 [00:11<00:02, 532.21it/s]Processing path items to SFT examples:  79%|███████▊  | 4946/6289 [00:11<00:03, 362.14it/s]Processing path items to SFT examples:  79%|███████▉  | 4998/6289 [00:12<00:05, 246.26it/s]Processing path items to SFT examples:  80%|████████  | 5038/6289 [00:12<00:04, 260.11it/s]Processing path items to SFT examples:  81%|████████  | 5108/6289 [00:12<00:03, 330.94it/s]Processing path items to SFT examples:  82%|████████▏ | 5178/6289 [00:12<00:02, 397.34it/s]Processing path items to SFT examples:  83%|████████▎ | 5232/6289 [00:12<00:02, 367.92it/s]Processing path items to SFT examples:  84%|████████▍ | 5282/6289 [00:13<00:02, 341.53it/s]Processing path items to SFT examples:  85%|████████▍ | 5324/6289 [00:13<00:05, 163.99it/s]Processing path items to SFT examples:  85%|████████▌ | 5373/6289 [00:13<00:04, 202.08it/s]Processing path items to SFT examples:  87%|████████▋ | 5454/6289 [00:13<00:03, 277.42it/s]Processing path items to SFT examples:  88%|████████▊ | 5506/6289 [00:14<00:02, 317.20it/s]Processing path items to SFT examples:  88%|████████▊ | 5553/6289 [00:14<00:02, 250.40it/s]Processing path items to SFT examples:  89%|████████▉ | 5617/6289 [00:14<00:02, 313.54it/s]Processing path items to SFT examples:  90%|█████████ | 5682/6289 [00:14<00:01, 376.09it/s]Processing path items to SFT examples:  91%|█████████ | 5733/6289 [00:14<00:01, 353.53it/s]Processing path items to SFT examples:  92%|█████████▏| 5798/6289 [00:14<00:01, 412.47it/s]Processing path items to SFT examples:  93%|█████████▎| 5864/6289 [00:14<00:00, 469.08it/s]Processing path items to SFT examples:  94%|█████████▍| 5919/6289 [00:15<00:00, 483.47it/s]Processing path items to SFT examples:  95%|█████████▍| 5974/6289 [00:15<00:00, 479.98it/s]Processing path items to SFT examples:  96%|█████████▌| 6027/6289 [00:15<00:00, 449.55it/s]Processing path items to SFT examples:  97%|█████████▋| 6076/6289 [00:15<00:00, 446.44it/s]Processing path items to SFT examples:  97%|█████████▋| 6123/6289 [00:15<00:00, 397.60it/s]Processing path items to SFT examples:  98%|█████████▊| 6166/6289 [00:15<00:00, 405.22it/s]Processing path items to SFT examples:  99%|█████████▉| 6248/6289 [00:15<00:00, 510.57it/s]Processing path items to SFT examples: 100%|██████████| 6289/6289 [00:15<00:00, 396.85it/s]
2025-05-13 15:05:15,221 - src.knowledge_graph - INFO - Closing Neo4j driver connection.
2025-05-13 15:05:15,221 - __main__ - INFO - SFT example generation complete. Total SFT examples: 20653
2025-05-13 15:05:15,459 - __main__ - INFO - SFT instruction dataset saved to JSON Lines: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_pn_kg_supplement_pos_shortest_paths/sft_data.jsonl
Saving the dataset (0/1 shards):   0%|          | 0/20653 [00:00<?, ? examples/s]Saving the dataset (1/1 shards): 100%|██████████| 20653/20653 [00:00<00:00, 862145.79 examples/s]Saving the dataset (1/1 shards): 100%|██████████| 20653/20653 [00:00<00:00, 857401.22 examples/s]
2025-05-13 15:05:15,738 - __main__ - INFO - SFT instruction dataset saved to Hugging Face disk format: /mnt/wangjingxiong/think_on_graph/data/finetune_sft/webqsp_train_sft_instruct_cand_pn_kg_supplement_pos_shortest_paths
